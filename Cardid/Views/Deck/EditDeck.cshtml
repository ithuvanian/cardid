@using Cardid.Models
@model Deck
@{
    ViewBag.Title = "Edit Deck: " + Model.DeckName;
}


<h2 class="view-title">
    Edit Your Deck |
    <span class="large-type">
        @Model.DeckName
    </span>
</h2>


<div class="flex flex-left">


    <div class="editdeck-left">

        <a href="@Url.Action("CreateCardInitD", "Card", new { deckID = Model.DeckID })" , class="btn main-btn">
            <span class="icons">
                &#xe900;
            </span>
            <span class="tab"></span>
            Add a card to this deck
        </a>

        <div>
            <div>
                <a href="@Url.Action("Index", "Deck")" class="btn main-btn">
                    <span class="icons">
                        &#xe922;
                    </span>
                    Back to decks
                </a>
            </div>

            <div>
                <div>
                    Study:
                </div>
                <a href="@Url.Action("StudyBegin", "Deck", new { deckID = Model.DeckID, frontFirst = true })" class="btn main-btn">
                    <span class="icons">
                        &#xe915;&nbsp;
                    </span>
                    Front first
                </a>
                <a href="@Url.Action("StudyBegin", "Deck", new { deckID = Model.DeckID, frontFirst = false })" class="btn main-btn">
                    <span class="icons">
                        &#xe915;&nbsp;
                    </span>
                    Back first
                </a>
            </div>

            <div>
                @if (Model.IsPublic == false)
                {
                    <p>
                        <span class="icons">
                            &#xe910;
                        </span>
                        This deck is visible only to you.
                    </p>
                    <a href="@Url.Action("MakeDeckPublic", "Deck", new { deckID = Model.DeckID })" class="btn main-btn">
                        <span class="icons">&#xe911;</span>
                        <span class="tab"></span>
                        Make public
                    </a>
                }
                else
                {
                    <p>
                        <span class="icons">
                            &#xe911;
                        </span>
                        This deck is visible to everyone.
                    </p>
                    <a href="@Url.Action("MakeDeckPrivate", "Deck", new { deckID = Model.DeckID })" class="btn main-btn">
                        <span class="icons">&#xe910;</span>
                        <span class="tab"></span>
                        Make private
                    </a>
                }
            </div>

            <div>

                @using (Html.BeginForm("ChangeDeckName", "Deck"))
                {
                    <button type="submit" class="btn main-btn">Rename deck</button>
                    @Html.HiddenFor(m => m.DeckID)
                    @Html.TextBoxFor(m => m.DeckName)
                }

            </div>
        </div>
    </div>

    <div class="editdeck-right module">
        @if (Model.Tags().Count > 0)
        {
            <div class="tag-container">
                <h4 class="bold at-top">Tags</h4>

                @foreach (Tag tag in Model.Tags())
                {
                    <span>
                        <span class="tag active-tag">@tag.TagName</span>
                        <a href="@Url.Action("RemoveDeckTag", "Deck", new { deckID = Model.DeckID, tagID = tag.TagID })">
                            <span class="icons delete-tag">
                                &#xe904;
                            </span>
                        </a>
                        <span class="tab"></span>
                    </span>
                }
            </div>
        }

        <h4 class="bold at-top">Add Tags</h4>
        <div class="tagviews">
            <span class="bold tagview-pop">sort by popularity</span>
            <span class="pointer tagview-alph">sort alphabetically</span>
        </div>

        <div class="tag-container">
            <div class="tags-pop">

                @foreach (Tag tag in Model.OtherTagsByPopularity())
                {
                    @Html.ActionLink(tag.TagName, "AddDeckTag", "Deck", new { deckID = Model.DeckID, tagID = tag.TagID }, new { @class = "tag inactive-tag" });
                }
            </div>

            <div class="tags-alph hidden">

                @foreach (Tag tag in Model.OtherTagsByName())
                {
                    @Html.ActionLink(tag.TagName, "SearchDeckTags", "Deck", new { searchString = tag.TagName }, new { @class = "tag inactive-tag" });
                }
            </div>
        </div>


        <div>
            <h4 class="bold">Create a new tag for this deck:</h4>

            @using (Html.BeginForm("CreateTagForDeck", "Deck", FormMethod.Post))
            {
                @Html.TextBoxFor(m => m.NewTag.TagName)

                @Html.HiddenFor(m => Model.DeckID)

                <button type="submit" class="btn main-btn">
                    <span class="icons">
                        &#xe900;
                    </span>
                    <span class="tab"></span>
                    Add tag
                </button>
            }
        </div>

    </div>
</div>



@if (Model.Cards().Count != 0)
{
    <div class="container-header">

        <h2 class="view-title">Cards in this deck:</h2>
        <div>
            <a href="@Url.Action("ChooseCardsInit", "Card", new { deckID = Model.DeckID })" class="btn main-btn">
                <span class="icons">
                    &#xe90f;
                </span>
                <span class="tab"></span>
                Find more cards to add
            </a>
        </div>
        <div>
            <a href="@Url.Action("CreateCardInitD", "Card", new { deckID = Model.DeckID })" class="btn main-btn">
                <span class="icons">
                    &#xe900;
                </span>
                <span class="tab"></span>
                Create card for this deck
            </a>
        </div>
    </div>

    <div class="flex flex-left">

        @foreach (Card thisCard in Model.Cards())
        {
            <div class="card-bothsides">
                <div class="card-field">@thisCard.Front</div>
                <div class="card-field">@thisCard.Back</div>
                <a href="@Url.Action("EditCardInitD", "Card", new { cardID = thisCard.CardID, deckID = Model.DeckID })" class="btn main-btn" id="edit-link">
                    <span class="icons">
                        &#xe90d;
                    </span>
                    <span class="tab"></span>
                    Edit this card
                </a>
                <a href="@Url.Action("RemoveCardFromDeck", "Deck", new { cardID = thisCard.CardID, deckID = Model.DeckID })" class="btn main-btn">
                    <span class="icons">
                        &#xe914;
                    </span>
                    <span class="tab"></span>
                    Remove from this deck
                </a>
            </div>
        }
    </div>
}
else
{
    <p>
        Currently no cards in this deck.
        @Html.ActionLink("Add some here", "ChooseCardsInit", "Card", new { deckID = Model.DeckID }, new { @class = "btn main-btn" })
    </p>
    <div>
    </div>
}

<div>
    <button class="btn delete-btn delete-init">
        <span class="icons">
            &#xe914;
        </span>
        <span class="tab"></span>
        Delete This Deck
    </button>

    @using (Html.BeginForm("DeleteDeck", "Deck", new { deckID = Model.DeckID }, FormMethod.Post, new { @class = "delete-submit" }))
    {
        <span>Deleting a deck will also delete all cards that exist only in that deck. Continue?</span>
        <div>
            <button type="reset" class="btn main-btn">
                <span class="icons">
                    &#xe922;
                </span>
                Cancel
            </button>
            <button type="submit" class="btn delete-btn">
                <span class="icons">
                    &#xe914;
                </span>
                Confirm Delete
            </button>
        </div>
    }
</div>


<script type="text/javascript" src="../../Content/editDeck.js"></script>
<script type="text/javascript" src="../../Content/deckTags.js"></script>
<script type="text/javascript" src="../../Content/cardView.js"></script>


